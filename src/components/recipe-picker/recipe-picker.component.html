<div class="fixed inset-0 bg-black/50 z-20 flex items-center justify-center" (click)="closePicker()">
  <div class="bg-gray-800 border border-gray-600 rounded-lg p-4 shadow-2xl animate-scale-in w-full max-w-md" (click)="$event.stopPropagation()">
    <h3 class="text-lg font-bold text-center text-white mb-4">Select a Recipe</h3>
    <div class="space-y-3 max-h-96 overflow-y-auto">
      @for (recipe of availableRecipes(); track recipe.id) {
        <button 
          (click)="selectRecipe(recipe.id)"
          [disabled]="!recipe.canAfford"
          class="w-full flex items-center p-3 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-left"
          [class]="recipe.canAfford ? 'bg-gray-700 hover:bg-green-700/50' : 'bg-gray-700'">

          <!-- Output -->
          <div class="flex items-center space-x-3 w-1/3">
            <span class="text-4xl">{{ recipe.outputItemAsset }}</span>
            <div>
              <div class="font-semibold">{{ itemService.getItem(recipe.outputId)?.name }}</div>
              <div class="text-xs text-gray-400">x{{ recipe.outputQuantity }}</div>
            </div>
          </div>
          
          <!-- Arrow & Duration -->
          <div class="flex flex-col items-center w-1/3 text-center">
            <svg class="w-6 h-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
            <span class="text-xs text-gray-500">{{ recipe.duration / 1000 }}s</span>
          </div>
          
          <!-- Inputs -->
          <div class="flex items-center justify-end space-x-4 w-1/3">
            @for (input of recipe.inputs.entries(); track input[0]) {
              <div class="flex flex-col items-center">
                <span class="text-3xl">{{ getIngredientAsset(input[0]) }}</span>
                <span class="text-xs font-semibold" [class]="(gameStateService.state().inventory.get(input[0]) || 0) >= input[1] ? 'text-gray-300' : 'text-red-400'">
                  {{ gameStateService.state().inventory.get(input[0]) || 0 }}/{{ input[1] }}
                </span>
              </div>
            }
          </div>
        </button>
      }
    </div>
  </div>
</div>

<style>
  .animate-scale-in {
    animation: scaleIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
  }
  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
</style>
