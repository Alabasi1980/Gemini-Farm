# 2. نظام الإنتاج (Production System)

---

نظام الإنتاج هو جوهر العمق الاقتصادي في Gemini Farm. يسمح للاعب بتحويل المواد الخام منخفضة القيمة (مثل المحاصيل) إلى سلع مصنعة عالية القيمة، مما يخلق فرصًا استراتيجية لتحقيق أرباح أكبر. ينقسم النظام إلى جزأين رئيسيين: **حظائر الحيوانات** و **المصانع**.

## 1. حظائر الحيوانات (Animal Housing)

حظائر الحيوانات هي مبانٍ خاصة تنتج منتجات حيوانية بشكل دوري.

-   **آلية العمل:**
    1.  يقوم اللاعب بشراء ووضع حظيرة (مثل `chicken_coop`).
    2.  بمجرد وضعها، تبدأ الحظيرة تلقائيًا في إنتاج منتجها المحدد (مثل `egg`).
    3.  بعد انقضاء `productionTime`، يصبح المنتج جاهزًا للجمع.
    4.  يقوم اللاعب بالنقر على الحظيرة لجمع المنتج وإضافته إلى مخزونه، ويبدأ مؤقت الإنتاج من جديد.

-   **مثال:** حظيرة الدجاج (`chicken_coop`) تنتج بيضة (`egg`) كل 60 ثانية.

-   **نموذج بيانات المنتج الحيواني (AnimalProduct Data Model):**
    -   `id`: معرف فريد (مثل `egg`).
    -   `name`: اسم العرض (مثل "Egg").
    -   `sellPrice`: سعر البيع الأساسي.
    -   `asset`: الرمز أو الصورة المستخدمة للعرض.

---

## 2. المصانع (Factories)

المصانع هي مبانٍ متقدمة تقوم بتحويل مجموعة من المدخلات (Inputs) إلى مخرجات (Outputs) بناءً على وصفات محددة.

-   **المفهوم الأساسي:** المصانع لا تنتج تلقائيًا. يجب على اللاعب أن يبدأ عملية الإنتاج يدويًا عن طريق اختيار وصفة واستهلاك المكونات اللازمة من مخزونه.

### أ. الوصفات (Recipes)

الوصفة هي "مخطط" الإنتاج الذي يتبعه المصنع.

-   **نموذج بيانات الوصفة (Recipe Data Model):**
    -   `id`: معرف فريد (مثل `wheat_to_flour`).
    -   `name`: اسم العرض (مثل "Grind Flour").
    -   `duration`: الوقت اللازم لإكمال الوصفة بالمللي ثانية.
    -   `inputs`: كائن يحدد المواد الخام المطلوبة وكمياتها (مثل `{ wheat: 2 }`).
    -   `outputId`: معرف المنتج النهائي.
    -   `outputQuantity`: كمية المنتج النهائي.

### ب. دورة عمل المصنع:

1.  **بدء الإنتاج:** ينقر اللاعب على مصنع فارغ، فتظهر له قائمة بالوصفات التي يمكن للمصنع تنفيذها.
2.  **اختيار الوصفة:** يختار اللاعب وصفة. يقوم النظام بالتحقق مما إذا كان اللاعب يمتلك المكونات المطلوبة في مخزونه.
3.  **استهلاك الموارد:** إذا كانت المكونات متوفرة، يتم خصمها من مخزون اللاعب.
4.  **الإنتاج:** يبدأ المصنع في العمل. يظهر شريط تقدم يوضح الوقت المتبقي.
5.  **التحصيل:** عند اكتمال الإنتاج، يصبح المنتج جاهزًا للجمع. ينقر اللاعب على المصنع لإضافة المنتج النهائي إلى مخزونه.

### ج. الميزات المتقدمة للمصانع:

-   **قائمة الانتظار (Production Queue):** يمكن للاعبين إضافة عدة وظائف إنتاج إلى قائمة انتظار المصنع. سيبدأ المصنع تلقائيًا في الوظيفة التالية بمجرد الانتهاء من الحالية (بعد أن يقوم اللاعب بجمع المنتج).
-   **الترقيات (Upgrades):** يمكن للاعبين إنفاق Coins لترقية مصانعهم. كل ترقية تزيد من:
    -   **سرعة الإنتاج (Speed):** يقلل `duration` كل الوصفات.
    -   **حجم قائمة الانتظار (Queue Size):** يسمح بإضافة المزيد من الوظائف في نفس الوقت.
-   **التشغيل التلقائي (Auto-Run):** يمكن للاعب تفعيل هذا الخيار لجعل المصنع يعيد إنتاج آخر وصفة تلقائيًا بمجرد جمع المنتج، طالما أن المكونات متوفرة.

-   **نموذج بيانات المنتج المصنع (ProcessedGood Data Model):**
    -   `id`: معرف فريد (مثل `flour`).
    -   `name`: اسم العرض (مثل "Flour").
    -   `sellPrice`: سعر البيع الأساسي (عادة ما يكون أعلى بكثير من مجموع أسعار مكوناته).
    -   `asset`: الرمز أو الصورة المستخدمة للعرض.
