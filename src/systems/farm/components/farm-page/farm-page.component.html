<div 
  class="relative h-full w-full overflow-hidden scene-container"
  [class]="[seasonClass(), weatherClass()]"
  (wheel)="onWheel($event)"
  (mousedown)="onMouseDown($event)"
  (mousemove)="onMouseMove($event)"
  (mouseup)="onMouseUp($event)"
  (mouseleave)="onMouseLeave()">

  <!-- HUD -->
  <app-hud></app-hud>

  <!-- Farm Scene -->
  <div class="absolute inset-0 sky-gradient transition-colors duration-1000"></div>
  <!-- Weather Effects -->
  <div class="weather-overlay"></div>
  
  <!-- Animated Clouds -->
  <div class="cloud cloud-1"></div>
  <div class="cloud cloud-2"></div>
  <div class="cloud cloud-3"></div>

  <div class="absolute inset-0 ground-gradient transition-colors duration-1000"></div>
  
  <div class="w-full h-full flex items-center justify-center transition-transform duration-75 ease-out" [style.transform]="cameraTransform()">
      <div class="interactive-child">
        <app-farm-grid></app-farm-grid>
      </div>
  </div>

  <!-- Crop Picker Overlay -->
  @if (showCropPicker() !== null) {
    <app-crop-picker 
      (cropSelected)="onCropSelected($event)" 
      (close)="onClosePicker()">
    </app-crop-picker>
  }

  <!-- Recipe Picker Overlay -->
  @if (showRecipePicker(); as factoryId) {
    <app-recipe-picker
      [factoryInstanceId]="factoryId"
      (recipeSelected)="onRecipeSelected($event)"
      (close)="onCloseRecipePicker()">
    </app-recipe-picker>
  }
</div>